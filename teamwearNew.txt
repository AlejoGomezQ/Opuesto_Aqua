<style>
/* ================= BRAND PALETTE ================= */
:root {
  --op-blue: #005CFF;
  --op-pink: #FF2E98;
  --op-purple: #5D00FF;
  --op-black: #111111;
  --op-light: #F5F5F7;
}

/* ================= LABEL ================= */
.label-title {
  display: block;
  margin: 24px 0 10px;
  font-weight: 700;
}

/* ================= SELECT ================= */
.select-wrapper {
  position: relative;
}

.select-wrapper select {
  width: 100%;
  padding: 14px 48px 14px 16px;
  border-radius: 14px;
  border: 2px solid var(--op-black);
  background: #fff;
  font-size: 15px;
  font-weight: 600;
  appearance: none;
}

.select-wrapper::after {
  content: "▼";
  position: absolute;
  right: 18px;
  top: 50%;
  transform: translateY(-50%);
  pointer-events: none;
}

/* ================= GRID ================= */
.product-card-container {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 26px;
  margin-top: 20px;
}

/* ================= CARD ================= */
.product-card {
  background: #fff;
  border: 2px solid #e3e3e3;
  border-radius: 18px;
  padding: 16px;
  text-align: center;
  cursor: pointer;
  transition: all .25s ease;
}

.product-card:hover {
  transform: translateY(-6px);
  border-color: var(--op-blue);
  box-shadow: 0 6px 20px rgba(0,92,255,.15);
}

.product-card.selected {
  border-color: var(--op-blue);
  box-shadow: 0 6px 20px rgba(0,92,255,.25);
}

.product-card img {
  width: 100%;
  height: 155px;
  object-fit: contain;
  border-radius: 12px;
  margin-bottom: 10px;
}

.product-card-name {
  font-weight: 700;
  font-size: 15px;
}

/* ================= COLOR SELECTOR ================= */
.color-selector {
  display: flex;
  flex-wrap: wrap;
  gap: 14px;
  margin-top: 12px;
  padding: 6px 0;
  justify-content: flex-start;
}

.color-swatch {
  width: 38px;
  height: 38px;
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid #e3e3e3;
  transition: transform .25s ease, box-shadow .25s ease, border-color .25s ease;
}

.color-swatch:hover {
  transform: scale(1.12);
  box-shadow: 0 0 12px rgba(0, 51, 255, .35);
}

.color-swatch.selected {
  border-color: #EF007F;
  box-shadow: 0 0 14px rgba(239, 0, 127, .45);
  transform: scale(1.18);
}

@media (max-width: 480px) {
  .color-swatch {
    width: 32px;
    height: 32px;
  }
}

/* ================= BADGE PRODUCT SELECTED ================= */
.product-badge {
  display: inline-flex;
  align-items: center;

  padding: 4px 12px;
  margin-left: 10px;

  font-size: 13px;
  font-weight: 600;
  line-height: 1;

  color: var(--op-blue);
  background: rgba(0, 92, 255, 0.08);
  border: 1px solid rgba(0, 92, 255, 0.35);
  border-radius: 999px;

  white-space: nowrap;
  transition: all .25s ease;
}

.product-badge.is-visible {
  animation: badgePop .3s ease;
}

@keyframes badgePop {
  from {
    opacity: 0;
    transform: translateY(-3px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* ================= DISCLAIMER ================= */
.design-disclaimer {
  margin-top: 14px;
  padding: 14px 16px;

  font-size: 13px;
  line-height: 1.45;

  color: #555;
  background: var(--op-light);
  border-left: 4px solid var(--op-blue);
  border-radius: 8px;
}

/* ===== PLACEMENTS ===== */

.placement-field {
  margin-bottom: 16px;
}

.placement-title {
  display: block;
  font-size: 14px;
  font-weight: 600;
  margin-bottom: 6px;
  color: var(--op-black);
}

.placement-option {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  font-size: 14px;
  color: var(--op-black);
}

/* Checkbox simple */
.placement-checkbox {
  width: 16px;
  height: 16px;
  cursor: pointer;
}

/* Nada raro cuando está seleccionado */
.placement-checkbox:checked {
  accent-color: var(--op-black);
}


/* ================= RESPONSIVE ================= */
@media (max-width:1024px){
  .product-card-container { grid-template-columns: repeat(2,1fr); }
}
@media (max-width:600px){
  .product-card-container { grid-template-columns: 1fr; }
}
</style>

<!-- ================= CATEGORY ================= -->
<label class="label-title"><strong>Category</strong></label>
<div class="select-wrapper">
  <select id="categorySelect">
    <option value="">Select a category...</option>
    <option value="shorts">Shorts</option>
    <option value="pants">Pants</option>
    <option value="jackets">Jackets</option>
    <option value="accessories">Accessories</option>
  </select>
</div>

<!-- ================= PRODUCTS ================= -->
<div id="productCardContainer" class="product-card-container"></div>

<!-- ================= DESIGNS ================= -->
<div id="designSection" style="display:none;">
  <label class="label-title">
    <strong>Choose your design</strong>
    <span id="selectedProductLabel" class="product-badge"></span>
  </label> 
  <div id="designCardContainer" class="product-card-container"></div>
</div>

<!-- ================= COLORS ================= -->
<div id="colorSection" style="display:none;">
  <label class="label-title"><strong>Color</strong></label>
  <div id="colorSelector" class="color-selector"></div>
</div>

<!-- ================= BREAKDOWN ================= -->
<div id="breakdownSection" style="display:none;">
  <label class="label-title"><strong>Garment breakdown</strong></label>
  <img id="breakdownImage" src="" style="width:100%; border-radius:14px; margin-top:12px;">
  <p class="design-disclaimer">
    Our mock-ups are intended to convey the concept and vision of your design.
    They do not represent an accurate depiction of the finished garment as it
    relates to design, fabric, colours, logo placement, and text placement.
    These are solely for visual purposes.
  </p>
</div>

<!-- ================= LOGO/TEXT PLACEMENTS ================= -->
<div id="logoSection" style="display:none;">
  <label class="label-title"><strong>Logo / Text placement</strong></label>
  <div id="logoSelectors"></div>
</div>

<!-- ================= HIDDEN ================= -->
<input type="hidden" id="selectedProduct" name="selectedProduct">
<input type="hidden" id="selectedDesign" name="selectedDesign">
<input type="hidden" id="selectedColor" name="selectedColor">
<input type="hidden" id="selectedPlacements" name="selectedPlacements">

<script>
/* =========================================================
   CATÁLOGO DE PRODUCTOS
   ========================================================= */
const catalog = {
  categories: {
    shorts: [
      {
        id: "XTS",
        name: "Female cross training (XTS)",
        image:
          "https://opuestoaqua.com/wp-content/uploads/2026/01/4-XTS-SUB01-FRONT.png",
        features: [],
        designs: [
          {
            id: "xts_design_1",
            name: "XTS - Design 1",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/4-XTS-SUB01-FRONT.png",
          },
          {
            id: "xts_design_2",
            name: "XTS - Design 2",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/5-XTS-SUB01-FRONT.png",
          },
          {
            id: "xts_design_3",
            name: "XTS - Design 3",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/8-XTS-SUB01-FRONT.png",
          },
          {
            id: "xts_design_4",
            name: "XTS - Design 4",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/16-XTS-SUB01-FRONT.png",
          },
          {
            id: "xts_design_5",
            name: "XTS - Design 5",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/24-XTS-SUB01-FRONT.png",
          },
          {
            id: "xts_design_6",
            name: "Build your own design",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/4-XTS-SUB01-FRONT.png",
          },
        ],
        breakdown: {
          image:
            "https://opuestoaqua.com/wp-content/uploads/2026/01/XTS-PLACEMENTS-scaled.jpg",
          placements: [
            { name: "Outside front waistband", options: ["Logo"] },
            { name: "Outside back waistband", options: ["Logo"] },
            { name: "Right front panel", options: ["Logo"] },
            { name: "Left front panel", options: ["Logo"] },
          ],
        },
      },
    ],
    pants: [
      {
        id: "JGR",
        name: "Jogger unisex (JGR)",
        image:
          "https://opuestoaqua.com/wp-content/uploads/2026/01/1-JGR-SUB01-2-FRONT.png",
        features: [],
        designs: [
          {
            id: "jgr_design_1",
            name: "JGR - Design 1",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/1-JGR-SUB01-2-FRONT.png",
          },
          {
            id: "jgr_design_2",
            name: "JGR - Design 2",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/1-JGR-SUB01-FRONT.png",
          },
          {
            id: "jgr_design_3",
            name: "JGR - Design 3",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/3-JGR-SUB01-FRONT.png",
          },
          {
            id: "jgr_design_4",
            name: "JGR - Design 4",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/6-JGR-SUB01-FRONT.png",
          },
          {
            id: "jgr_design_5",
            name: "JGR - Design 5",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/9-JGR-SUB01-FRONT.png",
          },
          {
            id: "jgr_design_6",
            name: "JGR - Design 6",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/15-JGR-SUB01-FRONT.png",
          },
          {
            id: "jgr_design_7",
            name: "Build your own design",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/1-JGR-SUB01-2-FRONT.png",
          },
        ],
        breakdown: null,
      },
      {
        id: "WUP",
        name: "Warmup pant unisex (WUP)",
        image:
          "https://opuestoaqua.com/wp-content/uploads/2026/01/7-WUP-SUB-FRONT.png",
        features: [],
        designs: [
          {
            id: "wup_design_1",
            name: "WUP - Design 1",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/2-WUP-SUB-FRONT.png",
          },
          {
            id: "wup_design_2",
            name: "WUP - Design 2",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/7-WUP-SUB-FRONT.png",
          },
          {
            id: "wup_design_3",
            name: "WUP - Design 3",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/10-WUP-SUB-FRONT.png",
          },
          {
            id: "wup_design_4",
            name: "Build your own design",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/7-WUP-SUB-FRONT.png",
          },
        ],
        breakdown: null,
      },
    ],
    jackets: [
      {
        id: "WBJ",
        name: "Windbreaker jacket unisex (WBJ)",
        image:
          "https://opuestoaqua.com/wp-content/uploads/2026/01/2-WBJ-SUB01-2-FRONT.png",
        features: [],
        designs: [
          {
            id: "wbj_design_1",
            name: "WBJ - Design 1",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/2-WBJ-SUB01-2-FRONT.png",
          },
          {
            id: "wbj_design_2",
            name: "WBJ - Design 2",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/2-WBJ-SUB01-FRONT.png",
          },
          {
            id: "wbj_design_3",
            name: "WBJ - Design 3",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/7-WBJ-SUB01-M-FRONT.png",
          },
          {
            id: "wbj_design_4",
            name: "WBJ - Design 4",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/10-WBJ-SUB01-FRONT.png",
          },
          {
            id: "wbj_design_5",
            name: "Build your own design",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/2-WBJ-SUB01-2-FRONT.png",
          },
        ],
        breakdown: null,
      },
      {
        id: "CWB",
        name: "Female crop windbreaker (CWB)",
        image:
          "https://opuestoaqua.com/wp-content/uploads/2026/01/4-CWB-SUB-FRONT-NEW.png",
        features: [],
        designs: [
          {
            id: "cwb_design_1",
            name: "CWB - Design 1",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/4-CWB-SUB-FRONT-NEW.png",
          },
          {
            id: "cwb_design_2",
            name: "CWB - Design 2",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/5-CWB-SUB-FRONT-NEW.png",
          },
          {
            id: "cwb_design_3",
            name: "CWB - Design 3",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/16-CWB-SUB-FRONT-NEW.png",
          },
          {
            id: "cwb_design_4",
            name: "Build your own design",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/4-CWB-SUB-FRONT-NEW.png",
          },
        ],
        breakdown: {
          image:
            "https://opuestoaqua.com/wp-content/uploads/2026/01/CWB-PLACEMENTS-scaled.jpg",
          placements: [
            { name: "Front chest", options: ["Logo", "Text"] },
            { name: "Upper back", options: ["Logo", "Text"] },
            { name: "Sleeve left", options: ["Logo", "Text"] },
            { name: "Sleeve right", options: ["Logo", "Text"] },
            { name: "Lower back", options: ["Logo", "Text"] },
          ],
        },
      },
      {
        id: "BJT",
        name: "Bomber jacket (BJT)",
        image:
          "https://opuestoaqua.com/wp-content/uploads/2026/01/15-BJT-SUB-FRONT-NEW.png",
        features: [],
        designs: [
          {
            id: "bjt_design_1",
            name: "BJT - Design 1",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/1-BJT-SUB-2-FRONT-NEW.png",
          },
          {
            id: "bjt_design_2",
            name: "BJT - Design 2",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/1-BJT-SUB-FRONT-NEW.png",
          },
          {
            id: "bjt_design_3",
            name: "BJT - Design 3",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/3-BJT-SUB-FRONT-NEW.png",
          },
          {
            id: "bjt_design_4",
            name: "BJT - Design 4",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/6-BJT-SUB-FRONT-NEW.png",
          },
          {
            id: "bjt_design_5",
            name: "BJT - Design 5",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/9-BJT-SUB-FRONT-NEW.png",
          },
          {
            id: "bjt_design_6",
            name: "BJT - Design 6",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/15-BJT-SUB-FRONT-NEW.png",
          },
          {
            id: "bjt_design_7",
            name: "Build your own design",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/15-BJT-SUB-FRONT-NEW.png",
          },
        ],
        breakdown: null,
      },
    ],
    accessories: [
      {
        id: "SLD",
        name: "Slides (SLD)",
        image:
          "https://opuestoaqua.com/wp-content/uploads/2026/01/1-SLD-SUB01.png",
        features: [],
        designs: [
          {
            id: "sld_design_1",
            name: "SLD - Design 1",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/1-SLD-SUB01.png",
          },
          {
            id: "sld_design_2",
            name: "SLD - Design 2",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/1-SLD-SUB01-2-NEW.png",
          },
          {
            id: "sld_design_3",
            name: "SLD - Design 3",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/4-SLD-SUB01.png",
          },
          {
            id: "sld_design_4",
            name: "SLD - Design 4",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/24-SLD-SUB01.png",
          },
          {
            id: "sld_design_5",
            name: "Build your own design",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/1-SLD-SUB01.png",
          },
        ],
        breakdown: null,
      },
      {
        id: "THS",
        name: "Team hair scrunchie (THS)",
        image:
          "https://opuestoaqua.com/wp-content/uploads/2026/01/2-THS-SUB01.png",
        features: [],
        designs: [
          {
            id: "ths_design_1",
            name: "THS - Design 1",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/2-THS-SUB01.png",
          },
          {
            id: "ths_design_2",
            name: "THS - Design 2",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/3-THS-SUB01.png",
          },
          {
            id: "ths_design_3",
            name: "THS - Design 3",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/21-THS-SUB01.png",
          },
          {
            id: "ths_design_4",
            name: "Build your own design",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/2-THS-SUB01.png",
          },
        ],
        breakdown: null,
      },
      {
        id: "BCK",
        name: "Backpak (BCK)",
        image:
          "https://opuestoaqua.com/wp-content/uploads/2026/01/8-MOCKUP-BCK-SUB01.png",
        features: [],
        designs: [
          {
            id: "bck_design_1",
            name: "BCK - Design 1",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/8-MOCKUP-BCK-SUB01.png",
          },
          {
            id: "bck_design_2",
            name: "BCK - Design 2",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/16-MOCKUP-BCK-SUB01.png",
          },
          {
            id: "bck_design_3",
            name: "BCK - Design 3",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/23-MOCKUP-BCK-SUB01-B.png",
          },
          {
            id: "bck_design_4",
            name: "BCK - Design 4",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/8-MOCKUP-BCK-SUB01-B.png",
          },
          {
            id: "bck_design_5",
            name: "Build your own design",
            image:
              "https://opuestoaqua.com/wp-content/uploads/2026/01/8-MOCKUP-BCK-SUB01.png",
          },
        ],
        breakdown: null,
      },
    ],
  },
};

/* =========================================================
   COLORES - PALETA OPUESTO
   ========================================================= */
const brandColors = [
  { name: "Jet Black", hex: "#000000" },
  { name: "Slate", hex: "#5B5555" },
  { name: "Clay", hex: "#94867B" },
  { name: "Pebble", hex: "#B8AFA8" },
  { name: "Navy", hex: "#01305C" },
  { name: "Plum", hex: "#4A0063" },
  { name: "Orchid", hex: "#7D0076" },
  { name: "Soft Violet", hex: "#CFA8F9" },
  { name: "Power Pink", hex: "#EF007F" },
  { name: "Bubblegum", hex: "#E7695E" },
  { name: "Coral", hex: "#F9847A" },
  { name: "Berry", hex: "#8D0022" },
  { name: "Crimson", hex: "#DC0000" },
  { name: "Tangerine", hex: "#FF6B21" },
  { name: "Walnut", hex: "#6B3D01" },
  { name: "Sienna", hex: "#AE5C2C" },
  { name: "Cobalt", hex: "#200F99" },
  { name: "Azure", hex: "#0089CF" },
  { name: "Sky", hex: "#A9BED6" },
  { name: "Peacock", hex: "#1F6481" },
  { name: "Teal", hex: "#358C95" },
  { name: "Seafoam", hex: "#7DDCC8" },
  { name: "Blush", hex: "#CA9281" },
  { name: "Pastel Pink", hex: "#FFE0E8" },
  { name: "Forest", hex: "#005130" },
  { name: "Olive", hex: "#6A6339" },
  { name: "Sandstone", hex: "#C7AE6B" },
  { name: "Lemonade", hex: "#FEED01" },
  { name: "Canary", hex: "#FFF387" },
  { name: "Volt", hex: "#51F210" },
  { name: "Ivory", hex: "#FFFFF0" },
  { name: "Bright White", hex: "#FFFFFF" }
];

/* =========================================================
   ELEMENTOS DOM
   ========================================================= */
const categorySelect = document.getElementById("categorySelect");
const selectedProductLabel = document.getElementById("selectedProductLabel");
const productCardContainer = document.getElementById("productCardContainer");

const designSection = document.getElementById("designSection");
const designCardContainer = document.getElementById("designCardContainer");

const colorSection = document.getElementById("colorSection");
const colorSelector = document.getElementById("colorSelector");

const breakdownSection = document.getElementById("breakdownSection");
const breakdownImage = document.getElementById("breakdownImage");

const logoSection = document.getElementById("logoSection");
const logoSelectors = document.getElementById("logoSelectors");

/* =========================================================
   ESTADO
   ========================================================= */
let currentProduct = null;

/* =========================================================
   ELEMENTOR
   ========================================================= */
function setElementorField(fieldName, value) {
  const el =
    document.querySelector(`input[name="form_fields[${fieldName}]"]`) ||
    document.getElementById(fieldName);

  if (el) el.value = value;
}

/* =========================================================
   RESET
   ========================================================= */
function resetAfterProductChange() {
  designSection.style.display = "none";
  colorSection.style.display = "none";
  breakdownSection.style.display = "none";
  logoSection.style.display = "none";

  setElementorField("selectedDesign", "");
  setElementorField("selectedColor", "");
  setElementorField("selectedPlacements", "");
}

/* =========================================================
   CATEGORY CHANGE
   ========================================================= */
categorySelect.addEventListener("change", e => {
  productCardContainer.innerHTML = "";
  resetAfterProductChange();
  currentProduct = null;

  setElementorField("selectedProduct", "");

  if (selectedProductLabel) {
    selectedProductLabel.textContent = "";
    selectedProductLabel.classList.add("is-visible");
  }

  const products = catalog.categories[e.target.value] || [];

  products.forEach(product => {
    productCardContainer.appendChild(
      createCard(product, el => selectProduct(product, el))
    );
  });
});

/* =========================================================
   PRODUCT SELECT
   ========================================================= */
function selectProduct(product, el) {
  selectSingle(".product-card", productCardContainer, el);

  currentProduct = product;
  setElementorField("selectedProduct", product.name);

  if (selectedProductLabel) {
    selectedProductLabel.textContent = `${product.name}`;
    selectedProductLabel.classList.add("is-visible");
  }

  resetAfterProductChange();
  renderDesigns(product);
}

/* =========================================================
   DESIGNS
   ========================================================= */
function renderDesigns(product) {
  designCardContainer.innerHTML = "";
  designSection.style.display = "block";

  product.designs.forEach(design => {
    designCardContainer.appendChild(
      createCard(design, el => {
        selectSingle(".product-card", designCardContainer, el);
        setElementorField("selectedDesign", design.name);

        colorSection.style.display = "none";
        setElementorField("selectedColor", "");

        renderBreakdownAndPlacements(product);
      })
    );
  });

  // Solid color
  designCardContainer.appendChild(
    createCard(
      {
        name: "Solid color",
        image:
          "https://images.icon-icons.com/1238/PNG/512/blacksquare_83753.png",
      },
      el => {
        selectSingle(".product-card", designCardContainer, el);
        setElementorField("selectedDesign", "Solid color");

        breakdownSection.style.display = "none";
        logoSection.style.display = "none";

        renderColors();
      }
    )
  );
}

/* =========================================================
   COLORS
   ========================================================= */
function renderColors() {
  colorSelector.innerHTML = "";
  colorSection.style.display = "block";

  setElementorField("selectedColor", "");

  brandColors?.forEach(color => {
    const swatch = document.createElement("div");
    swatch.className = "color-swatch";
    swatch.style.backgroundColor = color.hex;

    swatch.onclick = () => {
      colorSelector
        .querySelectorAll(".color-swatch")
        .forEach(c => c.classList.remove("selected"));

      swatch.classList.add("selected");
      setElementorField("selectedColor", `${color.name} (${color.hex})`);

      if (currentProduct) {
        renderBreakdownAndPlacements(currentProduct);
      }
    };

    colorSelector.appendChild(swatch);
  });
}

/* =========================================================
   BREAKDOWN + PLACEMENTS
   ========================================================= */
function renderBreakdownAndPlacements(product) {
  if (!product.breakdown) return;

  breakdownSection.style.display = "block";
  logoSection.style.display = "block";

  breakdownImage.src = product.breakdown.image;
  logoSelectors.innerHTML = "";

  const selected = [];

  product.breakdown.placements.forEach(place => {
    /* ================= WRAPPER ================= */
    const wrapper = document.createElement("div");
    wrapper.className = "placement-field";

    /* ================= TITLE ================= */
    const title = document.createElement("strong");
    title.className = "placement-title";
    title.textContent = place.name;
    wrapper.appendChild(title);

    /* ================= OPTION ================= */
    const option = place.options[0];

    const label = document.createElement("label");
    label.className = "placement-option";

    const checkbox = document.createElement("input");
    checkbox.type = "checkbox";
    checkbox.className = "placement-checkbox";

    checkbox.addEventListener("change", () => {
      const value = `${place.name}: ${option}`;

      if (checkbox.checked) {
        if (!selected.includes(value)) {
          selected.push(value);
        }
      } else {
        const index = selected.indexOf(value);
        if (index !== -1) selected.splice(index, 1);
      }

      setElementorField(
        "selectedPlacements",
        selected.join(" | ")
      );
    });

    const span = document.createElement("span");
    span.textContent = option;

    label.appendChild(checkbox);
    label.appendChild(span);
    wrapper.appendChild(label);

    logoSelectors.appendChild(wrapper);
  });
}

/* =========================================================
   HELPERS
   ========================================================= */
function createCard(data, onClick) {
  const card = document.createElement("div");
  card.className = "product-card";
  card.innerHTML = `
    <img src="${data.image}">
    <div>${data.name}</div>
  `;
  card.onclick = () => onClick(card);
  return card;
}

function selectSingle(selector, container, el) {
  container
    .querySelectorAll(selector)
    .forEach(c => c.classList.remove("selected"));
  el.classList.add("selected");
}
</script>